# CVRPTW Kyiv ALNS

Веб-приложение на Flask для решения задачи маршрутизации с временными окнами (CVRPTW) и гетерогенным флотом на дорожном графе Киева. Интерфейс использует Leaflet и ALNS-оптимизатор, построенный на реальных дорогах из OSM.

## Возможности
- Импорт заказов из CSV/Excel с геокодированием адресов через Nominatim и кэшированием результатов.
- Управление автопарком и выбор активных автомобилей.
- Установка депо кликом по карте или вводом координат/адреса.
- Построение маршрутов по дорожному графу OSM с учетом временных окон и вместимости.
- Отрисовка маршрутов на карте и вывод метрик по каждому автомобилю.

## Запуск
### 1. Подготовка окружения
```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

> Для Windows в последней строке используйте `Scripts\\activate` вместо `bin/activate`.

### 2. Старт локального сервера
```bash
export FLASK_APP=app        # Windows: set FLASK_APP=app
flask run --host 0.0.0.0 --port 5000
```

После запуска откройте интерфейс в браузере по адресу `http://localhost:5000`.

### 3. Что произойдёт при первом старте
- Скачается дорожный граф Киева через OSMnx и сохранится в `cache/graph_kiev.graphml`.
- Геокодирование адресов (Nominatim) и маршруты дорог также кэшируются в каталоге `cache/` для последующих запусков.

### 4. Импорт заказов и настройка
- Загрузите CSV/Excel с колонками: `id, address, volume, window_start, window_end` и опционально `lat, lon` (если координаты заданы, геокодирование не требуется).
- Установите точку депо кликом по карте или вводом адреса/координат.
- Отметьте активные автомобили в панели автопарка и нажмите кнопку запуска оптимизации.
